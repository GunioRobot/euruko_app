<% form_tag(:action => "create") do %>
  <ul>
  <% @events.each do |event| %>
    <% if event.is_paid_for_user?( current_user ) %>
      <li class="paid">
        X
        <%= event.name %> (<%= event.price_cents %>)
      </li>
    <% else %>
      <li>
        <%= 
          check_box_tag(
            "price_#{event.id}", 
            event.price_cents, 
            false, 
            :onchange => 'update_total_shoping_cart_price()'
          )
        %>
        <%= event.name %> (<%= event.price_cents %>)
      </li>
    <% end %>
  <% end %>
  </ul>
  
  <p>TOTAL: <span id="total">0</span></p>
  
  <p>
    <%= label_tag :bill_info %><br />
    <%= text_area_tag :bill_info %>
  </p>
  
  <p>
    <%= submit_tag "Pay, throught PayPal", :disabled => false, :disable_with => "Please wait..." %>
  </p>
<% end %>

<script>
  function update_total_shoping_cart_price(){
    total = 0;
    $(":checkbox").each(
      function() {
        if( this.checked ){
          total += parseInt(this.value);
        }
      }
    );

    $('#total').html( total + "" );
  }
  
  $(document).ready( function(){ update_total_shoping_cart_price(); } );
</script>